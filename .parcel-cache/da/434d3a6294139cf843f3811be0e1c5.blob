"use strict";

var helpers = require("../node_modules/@parcel/transformer-react-refresh-wrap/lib/helpers/helpers.js");

var prevRefreshReg = window.$RefreshReg$;
var prevRefreshSig = window.$RefreshSig$;
helpers.prelude(module);

try {
  Object.defineProperty(exports, "__esModule", {
    value: true
  });
  exports.default = void 0;

  var _react = _interopRequireDefault(require("react"));

  var _reactstrap = require("reactstrap");

  function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

  const MODEL = 'comentarios';
  const API_URL = "http://localhost:3000/api/" + MODEL;
  const HEADERS = new Headers({
    'Accept': 'application/json',
    'Content-Type': 'application/json'
  });

  class Comentario extends _react.default.Component {
    constructor(props) {
      super(props);
      this.state = {
        idcomentarios: 0,
        comentario: '',
        usuarioid: 1,
        distritoid: 1,
        lista: []
      };
      this.Guardar = this.Guardar.bind(this);
      this.cargaDatos = this.cargaDatos.bind(this);
      this.handleChange = this.handleChange.bind(this); //this.Borrar = this.Borrar.bind(this);
    }

    Guardar() {
      const comentario = {
        texto: this.state.comentario,
        distritos_iddistritos: this.props.idDistrito,
        usuarios_idusuarios: this.state.usuarioid
      };
      console.log(comentario);
      const opcions = {
        method: "POST",
        headers: HEADERS,
        body: JSON.stringify(comentario)
      };
      fetch(API_URL, opcions) // .then(respuesta => respuesta.json())
      // .then(ddd => console.log(ddd))
      .then(() => this.cargaDatos()).then(() => this.setState({
        idcomentarios: 0,
        comentario: '',
        usuarioid: 1,
        distritoid: 1
      })).catch(error => console.log("se ha producido un error: ", error));
    }

    componentDidMount() {
      this.cargaDatos();
    }

    cargaDatos() {
      const opcions = {
        method: "GET",
        headers: HEADERS
      };
      fetch(API_URL, opcions).then(texto => texto.json()).then(datos => this.setState({
        lista: datos
      })).catch(error => console.log("se ha producido un error: ", error));
    }

    handleChange(event) {
      const value = event.target.value;
      const name = event.target.name;
      this.setState({
        [name]: value
      });
    }
    /*Borrar(idcomentarios) {
        console.log("borrando " + idcomentarios);
        const opcions = {
            method: "DELETE",
            headers: HEADERS
        };
          const deleteURL = API_URL + '/' + idcomentarios;
          fetch(deleteURL, opcions)
            .then(respuesta => respuesta.json())
            .then(ddd => console.log(ddd))
            .then(() => this.cargaDatos())
            .catch(error => console.log("se ha producido un error: ", error));
        }*/


    render() {
      if (this.state.lista.length === 0) {
        console.log("cargando coments");
        return /*#__PURE__*/_react.default.createElement("h3", null, "Loading comments");
      }

      const filas = this.state.lista.map((el, i) => /*#__PURE__*/_react.default.createElement("div", {
        key: i
      }, /*#__PURE__*/_react.default.createElement("span", {
        style: {
          fontWeight: "bold"
        }
      }, /*#__PURE__*/_react.default.createElement("span", null, el.usuarios_idusuarios), /*#__PURE__*/_react.default.createElement("br", null), el.texto)));
      return /*#__PURE__*/_react.default.createElement(_react.default.Fragment, null, filas, /*#__PURE__*/_react.default.createElement("br", null), /*#__PURE__*/_react.default.createElement("h3", null, "Guarda tu comentario"), /*#__PURE__*/_react.default.createElement("div", {
        className: "inputs"
      }, /*#__PURE__*/_react.default.createElement(_reactstrap.Label, {
        for: "ComentInput"
      }, "Comentario"), /*#__PURE__*/_react.default.createElement(_reactstrap.Input, {
        type: "text",
        name: "comentario",
        value: this.state.comentario,
        onChange: this.handleChange
      }), /*#__PURE__*/_react.default.createElement("br", null), /*#__PURE__*/_react.default.createElement(_reactstrap.Button, {
        onClick: this.Guardar
      }, "Sube tu comentario")));
    }

  }

  var _default = Comentario;
  exports.default = _default;
  helpers.postlude(module);
} finally {
  window.$RefreshReg$ = prevRefreshReg;
  window.$RefreshSig$ = prevRefreshSig;
}